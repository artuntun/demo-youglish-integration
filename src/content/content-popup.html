<!DOCTYPE html>
<html lang="en">

<head>
  <style>
    /* Background color */
    :root {
      --background-color: #ffffff;
    }

    html,
    body {
      margin: 0;
      padding: 0;
      height: 100%;
      font-size: 14px;
      color: rgba(0, 0, 0, 0.8);
      line-height: 1.2;
      font-family: 'Inter', sans-serif;
    }

    .content {
      padding: 10px 20px;
    }

    .content-header {
      display: flex;
      justify-content: left;
      align-items: center;
    }
  </style>
</head>

<body>
  <div id="popup-container" style="display: flex; width: 100%; height: 100%; background-color: #ffffff">
    <div class="content" style="flex-grow: 1; overflow-y: auto;">
      <div class="content-header" id="content-header">
        <h3 id="header-title" style="margin: 0px;"></h3>
      </div>
      <div>
        <div id="widget-1"></div>
      </div>
    </div>
  </div>
  <script src="content_popup.js"></script>
  <script>
    // 2. This code loads the widget API code asynchronously.
    var tag = document.createElement('script');

    tag.src = "https://youglish.com/public/emb/widget.js";
    var firstScriptTag = document.getElementsByTagName('script')[0];
    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

    // 3. This function creates a widget after the API code downloads.
    var widget;
    function onYouglishAPIReady() {
      widget = new YG.Widget("widget-1", {
        width: 640,
        components: 9, //search box & caption 
        events: {
          'onFetchDone': onFetchDone,
          'onVideoChange': onVideoChange,
          'onCaptionConsumed': onCaptionConsumed
        }
      });
      // 4. process the query
      widget.fetch("courage", "english");
    }


    var views = 0, curTrack = 0, totalTracks = 0;

    // 5. The API will call this method when the search is done
    function onFetchDone(event) {
      if (event.totalResult === 0) alert("No result found");
      else totalTracks = event.totalResult;
    }

    // 6. The API will call this method when switching to a new video. 
    function onVideoChange(event) {
      curTrack = event.trackNumber;
      views = 0;
    }

    // 7. The API will call this method when a caption is consumed. 
    function onCaptionConsumed(event) {
      if (++views < 3)
        widget.replay();
      else
        if (curTrack < totalTracks)
          widget.next();
    }
  </script>
</body>

</html>